<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dark-Mode Sheet Dashboard</title>
<style>
    body {
        background-color: #121212;
        color: #e0e0e0;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }
    h1 { text-align: center; }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    th, td {
        padding: 10px;
        border: 1px solid #333;
        text-align: left;
    }
    th {
        background-color: #1f1f1f;
    }
    tr:nth-child(even) {
        background-color: #1a1a1a;
    }
    #views {
        text-align: center;
        margin-top: 20px;
        font-size: 1.2em;
        color: #90caf9;
    }
</style>
</head>
<body>
<h1>My Sheet Dashboard</h1>
<div id="views">Loading views...</div>
<table id="sheetTable">
    <thead>
        <tr id="headerRow"></tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
const SHEET_ID = '1d6U03chgX3RCUfE96pBGQY3NXJmn4LVb8pRWCqIa26Y';
const SHEET_NAME = 'Sheet1'; // Change to your sheet's tab name
const API_KEY = ''; // Optional if public sheet, otherwise use Google Sheets API key

// Basic view counter using localStorage
let views = localStorage.getItem('views') || 0;
views++;
localStorage.setItem('views', views);
document.getElementById('views').innerText = `Total Views: ${views}`;

// Fetch Sheet data as JSON
async function fetchSheet() {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;
    const res = await fetch(url);
    const text = await res.text();
    const json = JSON.parse(text.substr(47).slice(0, -2)); // Remove the gviz wrapper

    const cols = json.table.cols.map(c => c.label || ''); 
    const rows = json.table.rows.map(r => r.c.map(cell => cell ? cell.v : ''));

    // Populate table header
    const headerRow = document.getElementById('headerRow');
    cols.forEach(col => {
        const th = document.createElement('th');
        th.textContent = col;
        headerRow.appendChild(th);
    });

    // Populate table body
    const tbody = document.getElementById('tableBody');
    rows.forEach(row => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
            const td = document.createElement('td');
            td.textContent = cell;
            tr.appendChild(td);
        });
        tbody.appendChild(tr);
    });
}

// Load Sheet on page load
fetchSheet().catch(err => {
    console.error(err);
    document.getElementById('sheetTable').innerHTML = '<tr><td colspan="100%">Failed to load sheet</td></tr>';
});
</script>
</body>
</html>
